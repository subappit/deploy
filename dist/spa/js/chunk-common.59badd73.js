(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"29ef":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-table",{attrs:{data:e.data,columns:e.columns,"row-key":"name",bordered:"",filter:e.filter,"filter-method":e.customFilter,separator:"cell","pagination.sync":"pagination"},scopedSlots:e._u([{key:"top",fn:function(t){return[i("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),i("div",{staticClass:"q-ml-auto"},[i("q-btn",{attrs:{push:"",ripple:!1,label:"Carica RDO",color:"accent"},on:{click:function(t){return e.loadRdo()}}}),i("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})],1)]}},{key:"body",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-td",{key:"macroCategory",attrs:{"auto-width":!0,props:t}},[e._v("\n        "+e._s(t.row.rdo.rdos.descMacro)+"\n      ")]),i("q-td",{key:"subCategory",staticStyle:{"white-space":"normal"},attrs:{"auto-width":!0,props:t}},[e._v("\n        "+e._s(t.row.rdo.rdos.description)+"\n      ")]),i("q-td",{key:"imports",attrs:{"auto-width":!0,props:t}},e._l(t.row.rdo.imports,(function(t,s){return i("div",{key:s},[e._v("\n          "+e._s(t)+"\n        ")])})),0),i("q-td",{key:"regionOfInterest",attrs:{"auto-width":!0,props:t}},[e._v("\n        "+e._s(t.row.rdo.regionOfInterest.description)+"\n      ")]),i("q-td",{key:"expirationDate",attrs:{"auto-width":!0,props:t}},[e._v("\n        "+e._s(e.date.formatDate(t.row.rdo.expirationDate,"DD-MM-YYYY"))+"\n      ")]),i("q-td",{key:"viewRdo",attrs:{"auto-width":!0,props:t}},[i("q-icon",{staticClass:"text-accent cursor-pointer",staticStyle:{"font-size":"2rem"},attrs:{name:"search"},on:{click:function(i){return e.openRdo(t.row.rdo)}}})],1),e.allRdos?e._e():i("q-td",{key:"deleteRdo",attrs:{"auto-width":!0,props:t}},[i("q-icon",{staticClass:"text-negative cursor-pointer",staticStyle:{"font-size":"2rem"},attrs:{name:"delete_forever"},on:{click:function(i){return e.cancelRdo(t.row.rdo)}}})],1)],1)]}}])})},o=[],a=(i("e6cf"),i("ded3")),r=i.n(a),n=i("2f62"),l=i("bd4c"),d={name:"TableRdo",props:["allRdos"],data(){return{search:"",columns:[{name:"macroCategory",required:!0,label:"Macrocategoria",align:"center"},{name:"subCategory",required:!0,label:"Subcategoria",align:"center"},{name:"imports",required:!0,label:"Importo",align:"center"},{name:"regionOfInterest",required:!0,label:"Regione",align:"center"},{name:"expirationDate",required:!0,label:"Scadenza",align:"center"},{name:"viewRdo",required:!0,label:"Visualizza RDO",align:"center"}],data:[],date:l["b"]}},methods:r()(r()({},Object(n["b"])(["deleteRdo","fetchRdos","fetchUser"])),{},{getData(e){this.data.length>0&&(this.data=[]),e.forEach((e=>{const t={rdo:e};this.data.push(t)}))},openRdo(e){this.$emit("openSelectedRdo",e)},loadRdo(){this.$emit("resetSelectedRdo"),this.$emit("openModal")},async cancelRdo(e){this.$q.loading.show();const t={pathParam:e._id+"/"+this.userLogged._id},i={pathParam:this.userLogged._id};await this.deleteRdo(t),await this.fetchUser(i),this.getData(this.userLogged.loadedRdos),this.$q.loading.hide()},customFilter(e,t){const i=t.search?t.search.toLowerCase():"",s=e.filter(((e,t)=>{let s=!1,o=!0;if(""!==i){o=!1;const t=Object.values(e.rdo),s=t.map((e=>e.toString().toLowerCase()));for(let e=0;e<s.length;e++)if(s[e].includes(i)){o=!0;break}}return s=!1,o&&(s=!0),s}));return s}}),computed:r()(r()({},Object(n["c"])({userLogged:"user",boardRdos:"boardRdos"})),{},{filter(){return{search:this.search}}}),mounted(){if(this.allRdos){const e=this.boardRdos.filter((e=>e.user._id!==this.userLogged._id));this.getData(e)}else this.getData(this.userLogged.loadedRdos),this.columns.push({name:"deleteRdo",required:!0,label:"Elimina RDO",align:"center"})},watch:{boardRdos:{deep:!0,handler(e,t){if(this.allRdos){const t=e.filter((e=>e.user._id!==this.userLogged._id));this.getData(t)}}},userLogged:{deep:!0,handler(e,t){e&&!this.allRdos&&this.getData(e.loadedRdos)}}}},c=d,u=i("2877"),p=i("eaac"),h=i("27f9"),m=i("0016"),g=i("9c40"),f=i("bd08"),b=i("db86"),v=i("eebe"),R=i.n(v),y=Object(u["a"])(c,s,o,!1,null,"469160ea",null);t["a"]=y.exports;R()(y,"components",{QTable:p["a"],QInput:h["a"],QIcon:m["a"],QBtn:g["a"],QTr:f["a"],QTd:b["a"]})},"714b":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{attrs:{persistent:"",maximized:e.isMaximized,"transition-show":"slide-up","transition-hide":"slide-down"},on:{hide:e.hideDialog},model:{value:e.localModal,callback:function(t){e.localModal=t},expression:"localModal"}},[i("q-card",{class:{"bg-secondary":"login"===e.component}},[i("q-card-section",{staticClass:"relative-position bg-secondary "},[i("div",{staticClass:"text-h6 text-white text-center text-capitalize"},[e._v(e._s(e.title))]),i("div",{staticClass:"absolute-top-right z-max"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-white",attrs:{icon:"close",flat:"",round:"",dense:""}})],1)]),i("q-card-section",{class:e.classObj},["login"===e.component?i("login",{on:{loginSuccess:e.loginSuccess}}):e._e(),"sign-in"===e.component?i("sign-in",{attrs:{"is-admin":e.isAdmin,selectedUser:e.selectedUser,"is-editing":e.isEditing},on:{editSelectedUserSuccess:e.editSelectedUserSuccess,signupSuccess:e.signupSuccess,editSuccess:e.editSuccess}}):e._e(),"load-rdo"===e.component?i("load-rdo",{attrs:{"selected-rdo":e.selectedRdo},on:{loadRdoSuccess:e.signupSuccess}}):e._e()],1)],1)],1)},o=[],a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"q-pa-lg",staticStyle:{"min-width":"330px"}},[i("q-form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[i("q-input",{attrs:{type:"text",name:"username",label:"Username",autocomplete:"none",outlined:"","reactive-rules":"",rules:[function(t){return e.isValid("username",t,e.$v.user)}]},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),i("q-input",{attrs:{type:e.isPwd?"password":"text",name:"password",label:"Password",outlined:"","reactive-rules":"",rules:[function(t){return e.isValid("password",t,e.$v.user)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),i("div",{staticClass:"q-mt-lg q-pt-lg"},[i("q-btn",{staticClass:"full-width",attrs:{push:"",ripple:!1,label:"Log In",color:"secondary",type:"submit"}}),i("a",{staticClass:"q-pt-md block text-center cursor-pointer text-accent bold text-weight-bold"},[e._v("Password dimenticata?")])],1)],1)],1)},r=[],n=(i("e6cf"),i("ded3")),l=i.n(n),d=i("b5ae"),c=i("2f62"),u=i("8f04"),p={name:"Login",data(){return{user:{username:"",password:""},isValid:u["a"].isValid,isPassword:u["a"].isPassword,isPwd:!0}},methods:l()(l()({},Object(c["b"])(["login"])),{},{async onSubmit(){this.$v.$touch(),this.$forceUpdate(),this.$v.$invalid||(this.$q.loading.show(),await this.login(this.user),this.$q.loading.hide(),this.$emit("loginSuccess",!1))}}),validations:{user:{username:{required:d["required"],email:d["email"]},password:{required:d["required"],isPassword:u["a"].isPassword}}}},h=p,m=i("2877"),g=i("0378"),f=i("27f9"),b=i("0016"),v=i("9c40"),R=i("eebe"),y=i.n(R),C=Object(m["a"])(h,a,r,!1,null,null,null),q=C.exports;y()(C,"components",{QForm:g["a"],QInput:f["a"],QIcon:b["a"],QBtn:v["a"]});var _=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-form",{on:{submit:e.onSignup}},[i("q-stepper",{ref:"stepper",attrs:{"alternative-labels":"","done-color":"positive","error-color":"negative","active-color":"accent","transition-prev":"fade","transition-next":"fade",animated:"",flat:"","keep-alive":""},scopedSlots:e._u([{key:"navigation",fn:function(){return[i("q-stepper-navigation",{staticClass:"flex justify-between"},[i("div",[e.step>1?i("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",color:"primary",label:"Indietro"},on:{click:function(t){return e.$refs.stepper.previous()}}}):e._e()],1),i("div",[i("q-btn",{attrs:{type:"submit",disable:("false"===e.termAndCondition||"false"===e.regulation)&&3===e.step,color:"primary",label:e.getBtnLabel}})],1)])]},proxy:!0}]),model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[i("q-step",{staticClass:"scroll",attrs:{name:1,title:"Informazioni generali",icon:"settings",done:e.step>1}},[i("div",{staticClass:"row wrap justify-center content-center no-padding no-margin q-gutter-x-md q-gutter-y-lg"},[i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",disable:e.isEditing,label:"Username *","reactive-rules":"",name:"username",rules:[function(t){return e.isValid("username",t,e.$v.user)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n                "+e._s(e.$t("signin.tooltip.username"))+"\n              ")])],1)]},proxy:!0}]),model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),e.isEditing?e._e():i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",label:"Password *",type:e.isPsw?"password":"text","reactive-rules":"",name:"password",rules:[function(t){return e.isValid("password",t,e.$v.user)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPsw?"visibility_off":"visibility"},on:{click:function(t){e.isPsw=!e.isPsw}}})]},proxy:!0}],null,!1,1831663241),model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",label:"email PEC *","reactive-rules":"",name:"pec",rules:[function(t){return e.isValid("pec",t,e.$v.user)}]},model:{value:e.user.pec,callback:function(t){e.$set(e.user,"pec",t)},expression:"user.pec"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",disable:e.isEditing&&!e.isAdmin,name:"companyName",label:"Ragione sociale *","reactive-rules":"",rules:[function(t){return e.isValid("companyName",t,e.$v.user)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n                "+e._s(e.$t("signin.tooltip.companyName"))+"\n              ")])],1)]},proxy:!0}]),model:{value:e.user.companyName,callback:function(t){e.$set(e.user,"companyName",t)},expression:"user.companyName"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{outlined:"",disable:!0,"options-dense":!0,label:"Nazione *",options:e.countries,"option-label":"description","reactive-rules":"",name:"country","emit-value":"","map-options":"",rules:[function(t){return e.isValid("country",t,e.$v.user)}],"transition-show":"scale","transition-hide":"scale"},model:{value:e.user.country,callback:function(t){e.$set(e.user,"country",t)},expression:"user.country"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:!(e.user.country&&e.regions.length>0)||e.isEditing&&!e.isAdmin,readonly:!(e.user.country&&e.regions.length>0),options:e.regions,"option-label":"description","options-dense":!0,outlined:"",label:"Regione *",name:"region","emit-value":"","reactive-rules":"",rules:[function(t){return e.isValid("region",t,e.$v.user)}],"map-options":"","transition-show":"scale","transition-hide":"scale"},on:{input:e.getProvinceOptions},model:{value:e.user.region,callback:function(t){e.$set(e.user,"region",t)},expression:"user.region"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:!(e.user.region&&e.provinces.length>0)||e.isEditing&&!e.isAdmin,readonly:!(e.user.region&&e.provinces.length>0),"option-label":"description","option-dense":"",options:e.provinces,label:"Provincia *","reactive-rules":"",name:"region",rules:[function(t){return e.isValid("province",t,e.$v.user)}],"emit-value":"","map-options":"",outlined:"","transition-show":"scale","transition-hide":"scale"},on:{input:e.getCityOptions},model:{value:e.user.province,callback:function(t){e.$set(e.user,"province",t)},expression:"user.province"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:!(e.user.province&&e.cities.length>0)||e.isEditing&&!e.isAdmin,readonly:!(e.user.province&&e.cities.length>0),"option-label":"description","option-dense":"",options:e.cities,name:"city",outlined:"","map-options":"","emit-value":"",label:"Città *","reactive-rules":"",rules:[function(t){return e.isValid("city",t,e.$v.user)}],"transition-show":"scale","transition-hide":"scale"},model:{value:e.user.city,callback:function(t){e.$set(e.user,"city",t)},expression:"user.city"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",disable:e.isEditing&&!e.isAdmin,type:"number",label:"CAP *",name:"postalCode","reactive-rules":"",rules:[function(t){return e.isValid("postalCode",t,e.$v.user)}]},model:{value:e.user.postalCode,callback:function(t){e.$set(e.user,"postalCode",t)},expression:"user.postalCode"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",disable:e.isEditing&&!e.isAdmin,label:"Indirizzo sede legale *","reactive-rules":"",name:"registeredOfficeAddress",rules:[function(t){return e.isValid("registeredOfficeAddress",t,e.$v.user)}]},model:{value:e.user.registeredOfficeAddress,callback:function(t){e.$set(e.user,"registeredOfficeAddress",t)},expression:"user.registeredOfficeAddress"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",disable:e.isEditing&&!e.isAdmin,type:"text",label:"Partita IVA *","reactive-rules":"",name:"vatNumber",rules:[function(t){return e.isValid("vatNumber",t,e.$v.user)}]},model:{value:e.user.vatNumber,callback:function(t){e.$set(e.user,"vatNumber",t)},expression:"user.vatNumber"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",disable:e.isEditing&&!e.isAdmin,label:"Codice Fiscale *","reactive-rules":"",name:"fiscalCode",rules:[function(t){return e.isValid("fiscalCode",t,e.$v.user)}]},model:{value:e.user.fiscalCode,callback:function(t){e.$set(e.user,"fiscalCode",t)},expression:"user.fiscalCode"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",label:"Sito Web","reactive-rules":"",name:"webSite",rules:[function(t){return e.isValid("webSite",t,e.$v.user)}]},model:{value:e.user.webSite,callback:function(t){e.$set(e.user,"webSite",t)},expression:"user.webSite"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"number",label:"Telefono *","reactive-rules":"",name:"telephoneNumber",rules:[function(t){return e.isValid("telephoneNumber",t,e.$v.user)}]},model:{value:e.user.telephoneNumber,callback:function(t){e.$set(e.user,"telephoneNumber",t)},expression:"user.telephoneNumber"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",type:"text",label:"Codice SDI *","reactive-rules":"",name:"SDICode",rules:[function(t){return e.isValid("SDICode",t,e.$v.user)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n                "+e._s(e.$t("signin.tooltip.SDICode"))+"\n              ")])],1)]},proxy:!0}]),model:{value:e.user.SDICode,callback:function(t){e.$set(e.user,"SDICode",t)},expression:"user.SDICode"}}),i("div",{staticClass:"desktop-only col-md-3"}),i("div",{staticClass:"desktop-only col-md-3"})],1)]),i("q-step",{staticClass:"scroll full-height",attrs:{name:2,title:"Dati Azienda",icon:"create_new_folder",done:e.step>2}},[i("div",{staticClass:"row wrap justify-center content-center no-padding no-margin q-gutter-x-md q-gutter-y-xs"},[i("div",{staticClass:"col-12 col-md-3 order-1"},[i("span",[e._v("SOA")]),i("q-toggle",{attrs:{"checked-icon":"check",color:"accent","unchecked-icon":"clear"},model:{value:e.soaToggle,callback:function(t){e.soaToggle=t},expression:"soaToggle"}})],1),i("div",{staticClass:"col-12 col-md-3 order-3"},[i("span",[e._v("ISO")]),i("q-toggle",{attrs:{"checked-icon":"check",color:"accent","unchecked-icon":"clear"},model:{value:e.isoToggle,callback:function(t){e.isoToggle=t},expression:"isoToggle"}})],1),i("div",{staticClass:"col-12 col-md-3 order-5"},[i("span",[e._v("Patentino Fgas")]),i("q-toggle",{attrs:{"checked-icon":"check",color:"accent","unchecked-icon":"clear"},model:{value:e.fgasToggle,callback:function(t){e.fgasToggle=t},expression:"fgasToggle"}})],1),i("div",{staticClass:"col-12 col-md-3 order-2"},[i("q-file",{attrs:{disable:!e.soaToggle,label:"Carica quì il documento richiesto",accept:".pdf",outlined:"","use-chips":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.soaFile,callback:function(t){e.soaFile=t},expression:"soaFile"}})],1),i("div",{staticClass:"col-12 col-md-3 order-4"},[i("q-file",{attrs:{disable:!e.isoToggle,label:"Carica quì il documento richiesto",accept:".pdf",outlined:"","use-chips":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.isoFile,callback:function(t){e.isoFile=t},expression:"isoFile"}})],1),i("div",{staticClass:"col-12 col-md-3 order-6"},[i("q-file",{attrs:{disable:!e.fgasToggle,label:"Carica quì il documento richiesto",outlined:"",accept:".pdf","use-chips":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.fgasFile,callback:function(t){e.fgasFile=t},expression:"fgasFile"}})],1),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-7"},[e._v("\n          Richieste di offerta *\n        ")]),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("q-select",{staticClass:"col-12 col-md-3 order-8",attrs:{"use-chips":"",outlined:"","option-dense":"",options:e.macroRdo,"option-label":"description",label:"Macrocategoria",name:"macrocategory","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"","reactive-rules":"",rules:[function(t){return e.isValid("firstRdosMacrocategory",t,e.$v)}]},on:{input:e.getFirstCatRdoOption},model:{value:e.firstRdosMacrocategory,callback:function(t){e.firstRdosMacrocategory=t},expression:"firstRdosMacrocategory"}}),i("q-select",{staticClass:"col-12 col-md-3 order-9",attrs:{disable:!e.firstRdosMacrocategory,readonly:!e.firstRdosMacrocategory,outlined:"",options:e.firstCatRdo,"option-label":"description","options-dense":!0,label:"Categoria",multiple:"","use-chips":"",name:"category","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("firstRdosCategories",t,e.$v)}]},on:{input:e.getFirstSubcatRdoOption},model:{value:e.firstRdosCategories,callback:function(t){e.firstRdosCategories=t},expression:"firstRdosCategories"}}),i("q-select",{staticClass:"col-12 col-md-3 order-10",attrs:{disable:!e.firstRdosCategories.length>0,readonly:!e.firstRdosCategories.length>0,outlined:"",options:e.firstSubRdo,"option-label":"description","options-dense":!0,label:"Sottocategoria",multiple:"","use-chips":"",name:"subcategory","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("firstRdosSubcategories",t,e.$v)}]},model:{value:e.firstRdosSubcategories,callback:function(t){e.firstRdosSubcategories=t},expression:"firstRdosSubcategories"}}),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-11"},[e._v("\n          Importi *\n        ")]),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-13"},[e._v("\n          Regioni di interesse *\n        ")]),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("q-select",{staticClass:"col-12 col-md-3 order-12",attrs:{options:e.imports,name:"imports",outlined:"","option-dense":"",multiple:"",label:"Importi *","use-chips":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("firstImports",t,e.$v)}]},model:{value:e.firstImports,callback:function(t){e.firstImports=t},expression:"firstImports"}}),i("q-select",{staticClass:"col-12 col-md-3 order-14",attrs:{disable:!e.regions.length>0,readonly:!e.regions.length>0,outlined:"","options-dense":!0,options:e.regions,"option-label":"description",label:"Regioni di interesse *",multiple:"","use-chips":"","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("firstRegionsOfInterest",t,e.$v)}]},model:{value:e.firstRegionsOfInterest,callback:function(t){e.firstRegionsOfInterest=t},expression:"firstRegionsOfInterest"}}),i("div",{staticClass:"desktop-only col-12 col-md-3"},[e.needSecondRdo||e.isEditing?e._e():i("q-btn",{attrs:{flat:"",color:"secondary","icon-right":"add",label:"Aggiungi RDO"},on:{click:function(t){e.needSecondRdo=!0}}})],1),e.needSecondRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-7"},[e._v("\n          Richieste di offerta *\n        ")]):e._e(),e.needSecondRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needSecondRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needSecondRdo?i("q-select",{staticClass:"col-12 col-md-3 order-8",attrs:{"use-chips":"",outlined:"","option-dense":"",options:e.macroRdo,"option-label":"description",label:"Macrocategoria",name:"macrocategory","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"","reactive-rules":"",rules:[function(t){return e.isValid("secondRdosMacrocategory",t,e.$v)}]},on:{input:e.getSecondCatRdoOption},model:{value:e.secondRdosMacrocategory,callback:function(t){e.secondRdosMacrocategory=t},expression:"secondRdosMacrocategory"}}):e._e(),e.needSecondRdo?i("q-select",{staticClass:"col-12 col-md-3 order-9",attrs:{disable:!e.secondRdosMacrocategory,readonly:!e.secondRdosMacrocategory,outlined:"",options:e.secondCatRdo,"option-label":"description","options-dense":!0,label:"Categoria",multiple:"","use-chips":"",name:"category","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("secondRdosCategories",t,e.$v)}]},on:{input:e.getSecondSubcatRdoOption},model:{value:e.secondRdosCategories,callback:function(t){e.secondRdosCategories=t},expression:"secondRdosCategories"}}):e._e(),e.needSecondRdo?i("q-select",{staticClass:"col-12 col-md-3 order-10",attrs:{disable:!e.secondRdosCategories.length>0,readonly:!e.secondRdosCategories.length>0,outlined:"",options:e.secondSubRdo,"option-label":"description","options-dense":!0,label:"Sottocategoria",multiple:"","use-chips":"",name:"subcategory","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("secondRdosSubcategories",t,e.$v)}]},model:{value:e.secondRdosSubcategories,callback:function(t){e.secondRdosSubcategories=t},expression:"secondRdosSubcategories"}}):e._e(),e.needSecondRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-11"},[e._v("\n          Importi *\n        ")]):e._e(),e.needSecondRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-13"},[e._v("\n          Regioni di interesse *\n        ")]):e._e(),e.needSecondRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needSecondRdo?i("q-select",{staticClass:"col-12 col-md-3 order-12",attrs:{options:e.imports,name:"imports",outlined:"","option-dense":"",multiple:"",label:"Importi *","use-chips":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("secondImports",t,e.$v)}]},model:{value:e.secondImports,callback:function(t){e.secondImports=t},expression:"secondImports"}}):e._e(),e.needSecondRdo?i("q-select",{staticClass:"col-12 col-md-3 order-14",attrs:{disable:!e.regions.length>0,readonly:!e.regions.length>0,outlined:"","options-dense":!0,options:e.regions,"option-label":"description",label:"Regioni di interesse *",multiple:"","use-chips":"","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("secondRegionsOfInterest",t,e.$v)}]},model:{value:e.secondRegionsOfInterest,callback:function(t){e.secondRegionsOfInterest=t},expression:"secondRegionsOfInterest"}}):e._e(),e.needSecondRdo?i("div",{staticClass:"desktop-only col-12 col-md-3 flex"},[e.needThirdRdo||e.isEditing?e._e():i("q-btn",{attrs:{flat:"",color:"secondary","icon-right":"add",label:"Aggiungi RDO"},on:{click:function(t){e.needThirdRdo=!0}}}),e.needSecondRdo&&!e.isEditing?i("q-btn",{attrs:{flat:"",color:"negative","icon-right":"remove",label:"Rimuovi RDO"},on:{click:function(t){e.needSecondRdo=!1}}}):e._e()],1):e._e(),e.needThirdRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-7"},[e._v("\n          Richieste di offerta *\n        ")]):e._e(),e.needThirdRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needThirdRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needThirdRdo?i("q-select",{staticClass:"col-12 col-md-3 order-8",attrs:{"use-chips":"",outlined:"","option-dense":"",options:e.macroRdo,"option-label":"description",label:"Macrocategoria",name:"macrocategory","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"","reactive-rules":"",rules:[function(t){return e.isValid("thirdRdosMacrocategory",t,e.$v)}]},on:{input:e.getThirdCatRdoOption},model:{value:e.thirdRdosMacrocategory,callback:function(t){e.thirdRdosMacrocategory=t},expression:"thirdRdosMacrocategory"}}):e._e(),e.needThirdRdo?i("q-select",{staticClass:"col-12 col-md-3 order-9",attrs:{disable:!e.thirdRdosMacrocategory,readonly:!e.thirdRdosMacrocategory,outlined:"",options:e.thirdCatRdo,"option-label":"description","options-dense":!0,label:"Categoria",multiple:"","use-chips":"",name:"category","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("thirdRdosCategories",t,e.$v)}]},on:{input:e.getThirdSubcatRdoOption},model:{value:e.thirdRdosCategories,callback:function(t){e.thirdRdosCategories=t},expression:"thirdRdosCategories"}}):e._e(),e.needThirdRdo?i("q-select",{staticClass:"col-12 col-md-3 order-10",attrs:{disable:!e.thirdRdosCategories.length>0,readonly:!e.thirdRdosCategories.length>0,outlined:"",options:e.thirdSubRdo,"option-label":"description","options-dense":!0,label:"Sottocategoria",multiple:"","use-chips":"",name:"subcategory","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("thirdRdosSubcategories",t,e.$v)}]},model:{value:e.thirdRdosSubcategories,callback:function(t){e.thirdRdosSubcategories=t},expression:"thirdRdosSubcategories"}}):e._e(),e.needThirdRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-11"},[e._v("\n          Importi *\n        ")]):e._e(),e.needThirdRdo?i("div",{staticClass:"col-12 col-md-3 q-pt-md order-13"},[e._v("\n          Regioni di interesse *\n        ")]):e._e(),e.needThirdRdo?i("div",{staticClass:"desktop-only col-12 col-md-3"}):e._e(),e.needThirdRdo?i("q-select",{staticClass:"col-12 col-md-3 order-12",attrs:{options:e.imports,name:"imports",outlined:"","option-dense":"",multiple:"",label:"Importi *","use-chips":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("thirdImports",t,e.$v)}]},model:{value:e.thirdImports,callback:function(t){e.thirdImports=t},expression:"thirdImports"}}):e._e(),e.needThirdRdo?i("q-select",{staticClass:"col-12 col-md-3 order-14",attrs:{disable:!e.regions.length>0,readonly:!e.regions.length>0,outlined:"","options-dense":!0,options:e.regions,"option-label":"description",label:"Regioni di interesse *",multiple:"","use-chips":"","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("thirdRegionsOfInterest",t,e.$v)}]},model:{value:e.thirdRegionsOfInterest,callback:function(t){e.thirdRegionsOfInterest=t},expression:"thirdRegionsOfInterest"}}):e._e(),e.needThirdRdo?i("div",{staticClass:"desktop-only col-12 col-md-3 flex"},[e.needThirdRdo&&!e.isEditing?i("q-btn",{attrs:{flat:"",color:"negative","icon-right":"remove",label:"Rimuovi RDO"},on:{click:function(t){e.needThirdRdo=!1}}}):e._e()],1):e._e(),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-15"},[e._v("\n          Iscrizione White List o Dichiarazione Antimafia *\n        ")]),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-17"},[e._v("\n          Presentazione Aziendale *\n        ")]),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"col-12 col-md-3 order-16"},[i("q-file",{attrs:{label:"Carica quì il documento richiesto",accept:".pdf",outlined:"","use-chips":"",rules:[function(t){return e.isValid("antimafiaFile",t,e.$v)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.antimafiaFile,callback:function(t){e.antimafiaFile=t},expression:"antimafiaFile"}})],1),i("div",{staticClass:"col-12 col-md-3 order-18"},[i("q-file",{attrs:{label:"Carica quì il documento richiesto",outlined:"",accept:".pdf","use-chips":"",rules:[function(t){return e.isValid("lendingFile",t,e.$v)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.lendingFile,callback:function(t){e.lendingFile=t},expression:"lendingFile"}})],1),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-19"},[e._v("\n          Certificato o Visura Camerale *\n        ")]),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"col-12 col-md-3 order-20"},[i("q-file",{attrs:{label:"Carica quì il documento richiesto",outlined:"",accept:".pdf","use-chips":"",rules:[function(t){return e.isValid("certificateFile",t,e.$v)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.certificateFile,callback:function(t){e.certificateFile=t},expression:"certificateFile"}})],1),i("q-input",{staticClass:"col-12 col-md-2 order-21",attrs:{onkeydown:"return false",label:"Data Scadenza",rules:[function(t){return e.isValid("certificateDate",t,e.$v.user)}],outlined:"",mask:"##/##/####"},on:{click:function(t){return e.$refs.qDateCertificateProxy.show()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateCertificateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{locale:e.currentLocale,options:e.calendarOptionCertificate,mask:"DD/MM/YYYY"},model:{value:e.user.certificateDate,callback:function(t){e.$set(e.user,"certificateDate",t)},expression:"user.certificateDate"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annulla",color:"primary",flat:""}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.user.certificateDate,callback:function(t){e.$set(e.user,"certificateDate",t)},expression:"user.certificateDate"}}),i("div",{staticClass:"desktop-only col-12 col-md-4"}),i("div",{staticClass:"col-12 col-md-3 q-pt-md order-22"},[e._v("\n          Regolarità Durc *\n        ")]),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"desktop-only col-12 col-md-3"}),i("div",{staticClass:"col-12 col-md-3 order-23"},[i("q-file",{attrs:{label:"Carica quì il documento richiesto",outlined:"",accept:".pdf","use-chips":"",rules:[function(t){return e.isValid("durcRegolarityFile",t,e.$v)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.durcRegolarityFile,callback:function(t){e.durcRegolarityFile=t},expression:"durcRegolarityFile"}})],1),i("q-input",{staticClass:"col-12 col-md-2 order-24",attrs:{onkeydown:"return false",label:"Data Scadenza",rules:[function(t){return e.isValid("durcRegolarityDate",t,e.$v.user)}],outlined:"",mask:"##/##/####"},on:{click:function(t){return e.$refs.qDateDurcProxy.show()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateDurcProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{locale:e.currentLocale,options:e.calendarOptionDurc,mask:"DD/MM/YYYY"},model:{value:e.user.durcRegolarityDate,callback:function(t){e.$set(e.user,"durcRegolarityDate",t)},expression:"user.durcRegolarityDate"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annulla",color:"primary",flat:""}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.user.durcRegolarityDate,callback:function(t){e.$set(e.user,"durcRegolarityDate",t)},expression:"user.durcRegolarityDate"}}),i("div",{staticClass:"desktop-only col-12 col-md-4"}),e._e()],1)]),e.isEditing?e._e():i("q-step",{staticClass:"scroll",attrs:{name:3,title:"Consensi",icon:"add_comment"}},[i("div",{staticClass:"row wrap justify-center content-center no-padding no-margin q-gutter-x-md q-gutter-y-xs"},[i("div",{staticClass:"col-12 col-md-9 q-pt-md"},[e._v("\n         * Tutti i campi sono obbligatori.\n        ")]),i("div",{staticClass:"col-12 col-md-9 q-pt-md"},[e._v("\n         Al termine, riceverai una mail con le istruzioni da seguire per effettuare il pagamento e completare il processo di registrazione.\n        ")]),i("div",{staticClass:"col-12 col-md-9 q-pt-md"},[e._v("\n          Leggi e accetta il "),i("a",{staticClass:"hyperlink",on:{click:e.goToTeC}},[e._v("regolamento")]),e._v(" per godere dei vantaggi di Subapp.\n        ")]),i("div",{staticClass:"col-12 col-md-9 q-pt-md q-pb-md"},[i("div",{staticClass:"q-gutter-sm"},[i("q-radio",{attrs:{dense:"",val:"true",label:"Accetto"},model:{value:e.regulation,callback:function(t){e.regulation=t},expression:"regulation"}}),i("q-radio",{attrs:{dense:"",val:"false",label:"Non Accetto"},model:{value:e.regulation,callback:function(t){e.regulation=t},expression:"regulation"}})],1)]),i("div",{staticClass:"col-12 col-md-9 q-pt-md"},[e._v("\n          Leggi e accetta i "),i("a",{staticClass:"hyperlink",on:{click:e.goToTeC}},[e._v("Termini e Condizioni")]),e._v(" per proseguire con la registrazione.\n        ")]),i("div",{staticClass:"col-12 col-md-9 q-pt-md q-pb-md"},[i("div",{staticClass:"q-gutter-sm"},[i("q-radio",{attrs:{dense:"",val:"true",label:"Accetto"},model:{value:e.termAndCondition,callback:function(t){e.termAndCondition=t},expression:"termAndCondition"}}),i("q-radio",{attrs:{dense:"",val:"false",label:"Non Accetto"},model:{value:e.termAndCondition,callback:function(t){e.termAndCondition=t},expression:"termAndCondition"}})],1)]),e._e(),e._e(),e._e()])])],1)],1)},S=[],w=(i("e01a"),i("c975"),i("d539"));class D{constructor(){this.username="",this.password="",this.country=void 0,this.region=void 0,this.province=void 0,this.city=void 0,this.companyName="",this.SDICode="",this.vatNumber="",this.fiscalCode="",this.registeredOfficeAddress="",this.postalCode="",this.webSite="",this.pec="",this.telephoneNumber="",this.rdos={},this.soaFile={},this.isoFile={},this.fgasFile={},this.antimafiaFile={},this.lendingFile={},this.certificateFile={},this.durcRegolarityFile={},this.certificateDate="",this.durcRegolarityDate="",this.annual=!1,this.biennial=!1,this.subscriptionDate=null,this.blocked=!1,this.loadedRdos=[]}}var x=i("bd4c"),k={name:"SignIn",data(){return{user:new D,imports:w["imports"],compCatOptions:w["compCatOptions"],step:1,alert:!1,isPsw:!0,isValid:u["a"].isValid,isFiscalCode:u["a"].isFiscalCode,isSDICode:u["a"].isSDICode,isVatNumber:u["a"].isVatNumber,isPostalCode:u["a"].isPostalCode,isWebSite:u["a"].isWebSite,isTelephoneNumber:u["a"].isTelephoneNumber,isPassword:u["a"].isPassword,currentLocale:{days:"_Lunedì_Martedì_Mercoledì_Giovedì_Sabato_Domenica".split("_"),daysShort:"Lun_Mar_Mer_Gio_Ven_Sab_Dom".split("_"),months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),firstDayOfWeek:0},certificateFile:null,durcRegolarityFile:null,antimafiaFile:null,lendingFile:null,isoFile:null,soaFile:null,fgasFile:null,soaToggle:!1,isoToggle:!1,fgasToggle:!1,firstRdosCategories:[],firstRdosMacrocategory:null,firstRdosSubcategories:[],firstImports:[],firstRegionsOfInterest:[],secondRdosCategories:[],secondRdosMacrocategory:null,secondRdosSubcategories:[],secondImports:[],secondRegionsOfInterest:[],thirdRdosCategories:[],thirdRdosMacrocategory:null,thirdRdosSubcategories:[],thirdImports:[],needSecondRdo:!1,needThirdRdo:!1,thirdRegionsOfInterest:[],regulation:"false",termAndCondition:"false",compDeclaration:""}},props:["showAlert","isEditing","isAdmin","selectedUser"],methods:l()(l()({},Object(c["b"])(["getCountries","getRegions","getProvinces","getCities","signup","getMacroRdo","getCatRdo","getSubRdo","uploadFile","updateUser","fetchUser","updateLoggedUser","deleteFiles"])),{},{viewRegulation(){window.open("","_blank ")},async buildEditProfilePage(){this.isAdmin?this.user=JSON.parse(JSON.stringify(this.selectedUser)):this.user=JSON.parse(JSON.stringify(this.userLogged)),this.loadUserLoggedFile(),this.user.certificateDate=new Date(this.user.certificateDate).toLocaleDateString("fr"),this.user.durcRegolarityDate=new Date(this.user.durcRegolarityDate).toLocaleDateString("fr"),await this.getRegions(this.user.country._id),await this.getProvinces(this.user.region._id),await this.getCities(this.user.province._id);let e=[];e=this.loadEditProfileOptions("macroRdo",e),this.firstRdosMacrocategory=e.find((e=>"first"===e.position)).macro,await this.getFirstCatRdoOption(),this.firstImports=this.user.rdos.first.imports,this.firstRegionsOfInterest=this.user.rdos.first.regionsOfInterest,this.user.rdos.second&&(this.secondRdosMacrocategory=e.find((e=>"second"===e.position)).macro,await this.getSecondCatRdoOption(),this.secondImports=this.user.rdos.second.imports,this.secondRegionsOfInterest=this.user.rdos.second.regionsOfInterest,this.needSecondRdo=!0),this.user.rdos.third&&(this.thirdRdosMacrocategory=e.find((e=>"third"===e.position)).macro,await this.getThirdCatRdoOption(),this.thirdImports=this.user.rdos.third.imports,this.thirdRegionsOfInterest=this.user.rdos.third.regionsOfInterest,this.needThirdRdo=!0);let t=[];t=this.loadEditProfileOptions("firstCatRdo",t),this.firstRdosCategories=t.filter(((e,t,i)=>i.indexOf(e)===t)),await this.getFirstSubcatRdoOption(),this.user.rdos.second&&(t=[],t=this.loadEditProfileOptions("secondCatRdo",t),this.secondRdosCategories=t.filter(((e,t,i)=>i.indexOf(e)===t)),await this.getSecondSubcatRdoOption()),this.user.rdos.third&&(t=[],t=this.loadEditProfileOptions("thirdCatRdo",t),this.thirdRdosCategories=t.filter(((e,t,i)=>i.indexOf(e)===t)),await this.getThirdSubcatRdoOption());let i=[];i=this.loadEditProfileOptions("firstSubRdo",i),this.firstRdosSubcategories=i.filter(((e,t,i)=>i.indexOf(e)===t)),this.user.rdos.second&&(i=[],i=this.loadEditProfileOptions("secondSubRdo",i),this.secondRdosSubcategories=i.filter(((e,t,i)=>i.indexOf(e)===t))),this.user.rdos.third&&(i=[],i=this.loadEditProfileOptions("thirdSubRdo",i),this.thirdRdosSubcategories=i.filter(((e,t,i)=>i.indexOf(e)===t)))},loadEditProfileOptions(e,t){return Object.entries(this.user.rdos).forEach((i=>{i[1].subCategory.forEach((s=>{this[e].forEach((o=>{if("first"===i[0]){if("macroRdo"===e&&o._id===s.macrocategory){const e={position:i[0],macro:o},s=t.some((e=>"first"===e.position));s&&0!==t.length||t.push(e)}"firstCatRdo"===e&&o._id===s.category&&t.push(o),"firstSubRdo"===e&&o._id===s._id&&t.push(o)}else if("second"===i[0]){if("macroRdo"===e&&o._id===s.macrocategory){const e={position:i[0],macro:o},s=t.some((e=>"second"===e.position));s&&0!==t.length||t.push(e)}"secondCatRdo"===e&&o._id===s.category&&t.push(o),"secondSubRdo"===e&&o._id===s._id&&t.push(o)}else if("third"===i[0]){if("macroRdo"===e&&o._id===s.macrocategory){const e={position:i[0],macro:o},s=t.some((e=>"third"===e.position));s&&0!==t.length||t.push(e)}"thirdCatRdo"===e&&o._id===s.category&&t.push(o),"thirdSubRdo"===e&&o._id===s._id&&t.push(o)}}))}))})),t},loadUserLoggedFile(){this.user.soaFile&&(this.soaToggle=!0,this.soaFile=new File([""],"Soa")),this.user.isoFile&&(this.isoToggle=!0,this.isoFile=new File([""],"Iso")),this.user.fgasFile&&(this.fgasToggle=!0,this.fgasFile=new File([""],"Fgas")),this.antimafiaFile=new File([""],"Antimafia"),this.lendingFile=new File([""],"Presentazione"),this.certificateFile=new File([""],"Visura Camerale"),this.durcRegolarityFile=new File([""],"Durc")},goToTeC(){const e=this.$router.resolve({name:"termCondition"});window.open(e.href,"_blank")},hideDialog(){this.$emit("update:showAlert",this.alert)},calendarOptionCertificate(e){const t=new Date,i=new Date;return this.addMonths(i,6),e>=t.toLocaleDateString("fr-CA").replaceAll("-","/")&&e<=i.toLocaleDateString("fr-CA").replaceAll("-","/")},calendarOptionDurc(e){const t=new Date,i=new Date;return this.addMonths(i,4),e>=t.toLocaleDateString("fr-CA").replaceAll("-","/")&&e<=i.toLocaleDateString("fr-CA").replaceAll("-","/")},addMonths(e,t){var i=e.getDate();return e.setMonth(e.getMonth()+ +t),e.getDate()!==i&&e.setDate(0),e},async onSignup(){const e=this.user.certificateDate,t=this.user.durcRegolarityDate;if(!this.$v.$invalid&&3===this.step||!this.$v.$invalid&&2===this.step&&this.isEditing){this.step=1,this.firstRdosSubcategories&&this.firstRdosSubcategories.length>0&&(this.user.rdos.first={},this.user.rdos.first.subCategory=this.firstRdosSubcategories,this.user.rdos.first.imports=this.firstImports,this.user.rdos.first.regionsOfInterest=this.firstRegionsOfInterest),this.secondRdosSubcategories&&this.secondRdosSubcategories.length>0&&(this.user.rdos.second={},this.user.rdos.second.subCategory=this.secondRdosSubcategories,this.user.rdos.second.imports=this.secondImports,this.user.rdos.second.regionsOfInterest=this.secondRegionsOfInterest),this.thirdRdosSubcategories&&this.thirdRdosSubcategories.length>0&&(this.user.rdos.third={},this.user.rdos.third.subCategory=this.thirdRdosSubcategories,this.user.rdos.third.imports=this.thirdImports,this.user.rdos.third.regionsOfInterest=this.thirdRegionsOfInterest),this.$q.loading.show();try{this.user.certificateDate=x["b"].extractDate(this.user.certificateDate,"DD/MM/YYYY"),this.user.durcRegolarityDate=x["b"].extractDate(this.user.durcRegolarityDate,"DD/MM/YYYY");let i={};this.isEditing?i.user=this.user:i=await this.signup(this.user),await this.postFilesAndUpdateUser(i.user),this.isEditing&&this.$emit("editSuccess",!1),this.isAdmin&&this.$emit("editSelectedUserSuccess"),this.user.certificateDate=e,this.user.durcRegolarityDate=t,this.$q.loading.hide(),this.isEditing||this.$emit("signupSuccess",!1)}catch(i){this.user.certificateDate=e,this.user.durcRegolarityDate=t,this.$q.loading.hide(),console.log(i)}}this.$refs.stepper.next()},async postFilesAndUpdateUser(e){const t=new FormData;let i=!1;const s=[];if(this.antimafiaFile.size>0){const e=this.antimafiaFile.name.split("."),o=e[e.length-1];t.append("file",this.antimafiaFile,`antimafiaFile.${o}`),i=!0,this.isEditing&&this.user.antimafiaFile&&this.user.antimafiaFile.Key&&s.push(this.user.antimafiaFile.Key)}if(this.lendingFile.size>0){const e=this.lendingFile.name.split("."),o=e[e.length-1];t.append("file",this.lendingFile,`lendingFile.${o}`),i=!0,this.isEditing&&this.user.lendingFile&&this.user.lendingFile.Key&&s.push(this.user.lendingFile.Key)}if(this.certificateFile.size>0){const e=this.certificateFile.name.split("."),o=e[e.length-1];t.append("file",this.certificateFile,`certificateFile.${o}`),i=!0,this.isEditing&&this.user.certificateFile&&this.user.certificateFile.Key&&s.push(this.user.certificateFile.Key)}if(this.durcRegolarityFile.size>0){const e=this.durcRegolarityFile.name.split("."),o=e[e.length-1];t.append("file",this.durcRegolarityFile,`durcRegolarityFile.${o}`),i=!0,this.isEditing&&this.user.durcRegolarityFile&&this.user.durcRegolarityFile.Key&&s.push(this.user.durcRegolarityFile.Key)}if(this.soaFile&&this.soaFile.size>0){const e=this.soaFile.name.split("."),o=e[e.length-1];t.append("file",this.soaFile,`soaFile.${o}`),i=!0,this.isEditing&&this.user.soaFile&&this.user.soaFile.Key&&s.push(this.user.soaFile.Key)}if(this.isoFile&&this.isoFile.size>0){const e=this.isoFile.name.split("."),o=e[e.length-1];t.append("file",this.isoFile,`isoFile.${o}`),i=!0,this.isEditing&&this.user.isoFile&&this.user.isoFile.Key&&s.push(this.user.isoFile.Key)}if(this.fgasFile&&this.fgasFile.size>0){const e=this.fgasFile.name.split("."),o=e[e.length-1];t.append("file",this.fgasFile,`fgasFile.${o}`),i=!0,this.isEditing&&this.user.fgasFile&&this.user.fgasFile.Key&&s.push(this.user.fgasFile.Key)}if(i){if(s.length>0){console.log("filetoRemove",s);const e={pathParam:this.user._id,body:s};await this.deleteFiles(e)}const i=await this.uploadFile(t);i.files.forEach((t=>{e[t.Key.split(".")[1]]=t}))}if(this.isEditing){let t={pathParam:e._id,body:e};await this.updateLoggedUser(t),t={pathParam:e._id},this.isAdmin||await this.fetchUser(t)}else await this.postUser(e)},async postUser(e){const t={pathParam:e._id};t.body=e,await this.updateUser(t)},async getRegionOptions(){this.user.region&&(this.user.region=void 0),this.user.province&&(this.user.province=void 0),this.user.city&&(this.user.city=void 0),await this.getRegions(this.user.country._id)},async getProvinceOptions(){this.user.province&&(this.user.province=void 0),this.user.city&&(this.user.city=void 0),await this.getProvinces(this.user.region._id)},async getCityOptions(){this.user.city&&(this.user.city=void 0),await this.getCities(this.user.province._id)},async getFirstCatRdoOption(){if(this.firstRdosMacrocategory){const e={order:"first",queryparams:{rdomacroId:this.firstRdosMacrocategory._id}};await this.getCatRdo(e)}else this.firstRdosCategories=[],this.firstRdosSubcategories=[]},async getSecondCatRdoOption(){if(this.secondRdosMacrocategory){const e={order:"second",queryparams:{rdomacroId:this.secondRdosMacrocategory._id}};await this.getCatRdo(e)}else this.secondRdosCategories=[],this.secondRdosSubcategories=[]},async getThirdCatRdoOption(){if(this.thirdRdosMacrocategory){const e={order:"third",queryparams:{rdomacroId:this.thirdRdosMacrocategory._id}};await this.getCatRdo(e)}else this.thirdRdosCategories=[],this.thirdRdosSubcategories=[]},async getFirstSubcatRdoOption(){this.firstRdosCategories&&0===this.firstRdosCategories.length&&(this.firstRdosSubcategories=[]);const e={order:"first",queryparams:{rdocatId:this.firstRdosCategories.map((e=>e._id))}};await this.getSubRdo(e)},async getSecondSubcatRdoOption(){this.secondRdosCategories&&0===this.secondRdosCategories.length&&(this.secondRdosSubcategories=[]);const e={order:"second",queryparams:{rdocatId:this.secondRdosCategories.map((e=>e._id))}};await this.getSubRdo(e)},async getThirdSubcatRdoOption(){this.thirdRdosCategories&&0===this.thirdRdosCategories.length&&(this.thirdRdosSubcategories=[]);const e={order:"third",queryparams:{rdocatId:this.thirdRdosCategories.map((e=>e._id))}};await this.getSubRdo(e)}}),async mounted(){await this.getCountries(),this.user.country=this.countries.find((e=>"Italia"===e.description)),await this.getRegionOptions(),await this.getMacroRdo(),this.isEditing&&await this.buildEditProfilePage(),this.$v.$touch()},computed:l()(l()({},Object(c["c"])({userLogged:"user",countries:"countries",regions:"regions",provinces:"provinces",cities:"cities",macroRdo:"macroRdo",firstCatRdo:"firstCatRdo",secondCatRdo:"secondCatRdo",thirdCatRdo:"thirdCatRdo",firstSubRdo:"firstSubRdo",secondSubRdo:"secondSubRdo",thirdSubRdo:"thirdSubRdo"})),{},{getBtnLabel(){return 2===this.step&&this.isEditing?"Modifica":3===this.step?"Registrati":"Continua"}}),watch:{showAlert(e,t){t!==e&&(this.alert=e)},firstRdosMacrocategory(e,t){t!==e&&(this.firstRdosCategories=[],this.firstRdosSubcategories=[])}},validations(){return{user:{companyName:{required:d["required"]},SDICode:{required:d["required"],isSDICode:u["a"].isSDICode},vatNumber:{required:d["required"],isVatNumber:u["a"].isVatNumber},fiscalCode:{required:d["required"],isFiscalCode:u["a"].isFiscalCode},country:{required:d["required"]},region:{required:d["required"]},province:{required:d["required"]},city:{required:d["required"]},registeredOfficeAddress:{required:d["required"]},postalCode:{required:d["required"],isPostalCode:u["a"].isPostalCode},webSite:{isWebSite:""===this.user.webSite||u["a"].isWebSite},pec:{email:d["email"],required:d["required"]},telephoneNumber:{required:d["required"],isTelephoneNumber:u["a"].isTelephoneNumber},username:{required:d["required"],email:d["email"]},password:{required:!this.isEditing&&d["required"],isPassword:!!this.isEditing||u["a"].isPassword},durcRegolarityDate:{required:d["required"]},certificateDate:{required:d["required"]}},firstRdosSubcategories:{required:d["required"]},firstRdosMacrocategory:{required:d["required"]},firstRdosCategories:{required:d["required"]},firstImports:{required:d["required"]},firstRegionsOfInterest:{required:d["required"]},secondRdosSubcategories:{required:!!this.needSecondRdo&&d["required"]},secondRdosMacrocategory:{required:!!this.needSecondRdo&&d["required"]},secondRdosCategories:{required:!!this.needSecondRdo&&d["required"]},secondImports:{required:!!this.needSecondRdo&&d["required"]},secondRegionsOfInterest:{required:!!this.needSecondRdo&&d["required"]},thirdRdosSubcategories:{required:!!this.needThirdRdo&&d["required"]},thirdRdosMacrocategory:{required:!!this.needThirdRdo&&d["required"]},thirdRdosCategories:{required:!!this.needThirdRdo&&d["required"]},thirdImports:{required:!!this.needThirdRdo&&d["required"]},thirdRegionsOfInterest:{required:!!this.needThirdRdo&&d["required"]},durcRegolarityFile:{required:d["required"]},antimafiaFile:{required:d["required"]},certificateFile:{required:d["required"]},lendingFile:{required:d["required"]}}}},F=k,$=i("f531"),O=i("87fe"),I=i("05c0"),M=i("ddd8"),A=i("9564"),P=i("7d53"),E=i("7cbe"),T=i("52ee"),z=i("9f0a"),L=i("3786"),V=i("b19c"),N=i("7f67"),Q=Object(m["a"])(F,_,S,!1,null,"826e2e94",null),Y=Q.exports;y()(Q,"components",{QForm:g["a"],QStepper:$["a"],QStep:O["a"],QInput:f["a"],QIcon:b["a"],QTooltip:I["a"],QSelect:M["a"],QToggle:A["a"],QFile:P["a"],QBtn:v["a"],QPopupProxy:E["a"],QDate:T["a"],QOptionGroup:z["a"],QRadio:L["a"],QStepperNavigation:V["a"]}),y()(Q,"directives",{ClosePopup:N["a"]});var U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-form",{on:{submit:e.loadRdo}},[i("div",{staticClass:"row wrap justify-center content-center q-pt-lg no-margin q-gutter-x-md q-gutter-y-xs"},[i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",disable:!0,type:"text",label:"Appaltatore *","reactive-rules":"",name:"contractor",rules:[function(t){return e.isValid("contractor",t,e.$v.rdo)}]},model:{value:e.rdo.contractor,callback:function(t){e.$set(e.rdo,"contractor",t)},expression:"rdo.contractor"}}),null==e.selectedRdo||e.rdo.user._id==e.userLogged._id||e.userLogged.admin?e._e():i("div",{staticClass:"col-12 col-md-3"},[i("div",[e._v("Ribasso del "),i("span",{staticStyle:{color:"#29ABF4","font-weight":"bold"}},[e._v(e._s(e.ribasso)+"%")])]),[i("q-slider",{attrs:{min:0,max:100,step:1,label:"","label-value":e.ribasso+"%",color:"accent"},model:{value:e.ribasso,callback:function(t){e.ribasso=t},expression:"ribasso"}})]],2),null==e.selectedRdo||e.rdo.user._id==e.userLogged._id||e.userLogged.admin?i("div",{staticClass:"desktop-only col-md-3"}):e._e(),i("div",{staticClass:"desktop-only col-md-3"}),i("q-input",{staticClass:"col-12 col-md-3 ",attrs:{outlined:"",label:"Descrizione *",type:"textarea",name:"description",disable:null!=e.selectedRdo,"reactive-rules":"",rules:[function(t){return e.isValid("description",t,e.$v.rdo)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n            Fornici una breve descrizione dell’appalto\n          ")])],1)]},proxy:!0}]),model:{value:e.rdo.description,callback:function(t){e.$set(e.rdo,"description",t)},expression:"rdo.description"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",label:"Documenti necessari",type:"textarea",name:"requiredDocuments",disable:null!=e.selectedRdo,"reactive-rules":"",rules:[function(e){return!0}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n            Indica se vi sono documenti di primaria importanza ai fini del subappalto\n          ")])],1)]},proxy:!0}]),model:{value:e.rdo.requiredDocuments,callback:function(t){e.$set(e.rdo,"requiredDocuments",t)},expression:"rdo.requiredDocuments"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",label:"Eventuali problematiche o peculiarità",type:"textarea",name:"peculiarity",disable:null!=e.selectedRdo,"reactive-rules":"",rules:[function(e){return!0}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n            Indica se vi sono problematiche o peculiarità di cui il subappaltatore dovrà tenere conto nella formulazione dell’offerta\n          ")])],1)]},proxy:!0}]),model:{value:e.rdo.peculiarity,callback:function(t){e.$set(e.rdo,"peculiarity",t)},expression:"rdo.peculiarity"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{onkeydown:"return false",disable:null!=e.selectedRdo,label:"Data scadenza *",rules:[function(t){return e.isValid("expirationDate",t,e.$v)}],outlined:"",mask:"##/##/####"},on:{click:function(t){return e.$refs.qDateProxy.show()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{readonly:e.selectedRdo,locale:e.currentLocale,options:e.calendarDataScadenza,mask:"DD/MM/YYYY"},on:{input:e.resetStartEndDate},model:{value:e.expirationDate,callback:function(t){e.expirationDate=t},expression:"expirationDate"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annulla",color:"primary",flat:""}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"primary",flat:""}})],1)])],1)],1),i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n            Termine entro il quale presentare l'offerta (massimo 30 giorni)\n          ")])],1)]},proxy:!0}]),model:{value:e.expirationDate,callback:function(t){e.expirationDate=t},expression:"expirationDate"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{onkeydown:"return false",disable:null!=e.selectedRdo||null==e.expirationDate,label:" Data prevista per inizio appalto *",rules:[function(t){return e.isValid("startDate",t,e.$v)}],outlined:"",mask:"##/##/####"},on:{click:function(t){return e.$refs.startDateProxy.show()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"startDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{readonly:e.selectedRdo,disable:null==e.expirationDate,locale:e.currentLocale,options:e.calendarDataInizio,mask:"DD/MM/YYYY"},on:{input:e.resetEndDate},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annulla",color:"primary",flat:""}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}}),i("q-input",{staticClass:"col-12 col-md-3",attrs:{onkeydown:"return false",disable:null!=e.selectedRdo||null==e.expirationDate||null==e.startDate,label:" Data presunta fine appalto *",rules:[function(t){return e.isValid("endDate",t,e.$v)}],outlined:"",mask:"##/##/####"},on:{click:function(t){return e.$refs.endDateProxy.show()}},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"endDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{locale:e.currentLocale,options:e.calendarDataFine,mask:"DD/MM/YYYY"},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm",attrs:{disable:null==e.expirationDate||null==e.startDate}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annulla",color:"primary",flat:""}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}}),e.selectedRdo?e._e():i("q-select",{staticClass:"col-12 col-md-3",attrs:{outlined:"","options-dense":!0,disable:!0,label:"Nazione *",options:e.countries,"option-label":"description","reactive-rules":"",name:"country","emit-value":"","map-options":"",rules:[function(t){return e.isValid("country",t,e.$v)}],"transition-show":"scale","transition-hide":"scale"},model:{value:e.country,callback:function(t){e.country=t},expression:"country"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:!(e.country&&e.regions.length>0),readonly:!(e.country&&e.regions.length>0&&!e.selectedRdo),options:e.regions,"option-label":"description","options-dense":!0,outlined:"",label:"Regione *",name:"region","emit-value":"","reactive-rules":"",rules:[function(t){return e.isValid("regionOfInterest",t,e.$v.rdo)}],"map-options":"","transition-show":"scale","transition-hide":"scale"},model:{value:e.rdo.regionOfInterest,callback:function(t){e.$set(e.rdo,"regionOfInterest",t)},expression:"rdo.regionOfInterest"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{options:e.imports,disable:null!=e.selectedRdo,name:"imports",outlined:"","option-dense":"",label:"Importi *","use-chips":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("imports",t,e.$v.rdo)}]},model:{value:e.rdo.imports,callback:function(t){e.$set(e.rdo,"imports",t)},expression:"rdo.imports"}}),e.selectedRdo?i("div",{staticClass:"desktop-only col-md-3"}):e._e(),i("q-select",{staticClass:"col-12 col-md-3",attrs:{"use-chips":"",outlined:"","option-dense":"",disable:null!=e.selectedRdo,options:e.macroRdo,"option-label":"description",label:"Macrocategoria RDO",name:"macrocategory","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"","reactive-rules":"",rules:[function(t){return e.isValid("rdosMacrocategories",t,e.$v)}]},on:{input:e.getCatRdoOption},model:{value:e.rdosMacrocategories,callback:function(t){e.rdosMacrocategories=t},expression:"rdosMacrocategories"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:null==e.rdosMacrocategories||null!=e.selectedRdo,readonly:null==e.rdosMacrocategories||null!=e.selectedRdo,outlined:"",options:e.firstCatRdo,"option-label":"description","options-dense":!0,label:"Categoria RDO","use-chips":"",name:"category","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("rdosCategories",t,e.$v)}]},on:{input:e.getSubcatRdoOption},model:{value:e.rdosCategories,callback:function(t){e.rdosCategories=t},expression:"rdosCategories"}}),i("q-select",{staticClass:"col-12 col-md-3",attrs:{disable:null==e.rdosCategories||null!=e.selectedRdo,readonly:null==e.rdosCategories||null!=e.selectedRdo,outlined:"",options:e.firstSubRdo,"option-label":"description","options-dense":!0,label:"Sottocategoria RDO","use-chips":"",name:"subcategory","emit-value":"","map-options":"","transition-show":"scale","transition-hide":"scale","reactive-rules":"",rules:[function(t){return e.isValid("rdosSubcategories",t,e.$v)}]},model:{value:e.rdosSubcategories,callback:function(t){e.rdosSubcategories=t},expression:"rdosSubcategories"}}),i("div",{staticClass:"col-12 col-md-3"},[e.selectedRdo?e._e():i("q-file",{attrs:{label:"Carica quì il CME *",accept:".pdf",outlined:"","use-chips":"",rules:[function(t){return e.isValid("cmeFile",t,e.$v)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}],null,!1,2664251742),model:{value:e.cmeFile,callback:function(t){e.cmeFile=t},expression:"cmeFile"}})],1),i("div",{staticClass:"col-12 col-md-3"},[e.selectedRdo?e._e():i("q-file",{attrs:{label:"Carica quì eventuali immagini",accept:".png, .jpeg, .jpg",multiple:"",outlined:"","use-chips":"",rules:[function(e){return!0}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}],null,!1,2664251742),model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1),i("div",{staticClass:"col-12 col-md-3"},[e.selectedRdo?e._e():i("q-file",{attrs:{label:"Carica quì eventuali file tecnici",accept:".pdf",multiple:"",outlined:"","use-chips":"",rules:[function(e){return!0}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}],null,!1,2664251742),model:{value:e.technicalFiles,callback:function(t){e.technicalFiles=t},expression:"technicalFiles"}})],1),i("q-input",{staticClass:"col-12 col-md-3",attrs:{outlined:"",label:"Contatto referente *","reactive-rules":"",name:"reference",disable:null!=e.selectedRdo,rules:[function(t){return e.isValid("reference",t,e.$v.rdo)}]},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"desktop-only text-secondary",attrs:{name:"info"}},[i("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle","content-class":"bg-accent","content-style":"font-size: 13px",offset:[10,10]}},[e._v("\n            Contatto del responsabile al quale poter eventualmente richiedere maggiori informazioni. Può essere un recapito telefonico o un indirizzo email.\n          ")])],1)]},proxy:!0}]),model:{value:e.rdo.reference,callback:function(t){e.$set(e.rdo,"reference",t)},expression:"rdo.reference"}}),i("div",{staticClass:"col-12 col-md-3 flex column justify-center",staticStyle:{height:"56px"}},[i("div",[i("span",[e._v("Disponibilità sopralluoghi")]),i("q-toggle",{attrs:{"checked-icon":"check",color:"accent","unchecked-icon":"clear",disable:null!=e.selectedRdo},model:{value:e.rdo.needInspection,callback:function(t){e.$set(e.rdo,"needInspection",t)},expression:"rdo.needInspection"}})],1)]),i("div",{staticClass:"desktop-only col-md-3"}),null!=e.selectedRdo?i("div",{staticClass:"col-12 col-md-3"},[i("q-table",{attrs:{title:"Lista file",data:e.data,columns:e.columns,"row-key":"name",bordered:"",separator:"cell"},scopedSlots:e._u([{key:"body",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-td",{key:"description",attrs:{props:t}},[i("div",[e._v("\n                "+e._s(t.row.file.Key.split(".")[1])+" "),null!=t.row.file.index?i("span",[e._v(" n. "+e._s(t.row.file.index+1))]):e._e()])]),i("q-td",{key:"download",attrs:{props:t}},[t.row.file.Key?i("q-icon",{staticClass:"text-accent cursor-pointer",staticStyle:{"font-size":"2rem"},attrs:{name:"file_download"},on:{click:function(i){return e.downloadFile(t.row.file.Key)}}}):e._e()],1)],1)]}}],null,!1,2013977537)},[[i("div",{staticClass:"col-2 q-table__title"},[e._v("Lista file")])]],2)],1):e._e(),null!=e.selectedRdo?i("div",{staticClass:"desktop-only col-md-3"}):e._e(),null!=e.selectedRdo?i("div",{staticClass:"desktop-only col-md-3"}):e._e(),i("div",{staticClass:"col-12 row justify-center q-pt-xl q-pb-xl no-margin"},[null==e.selectedRdo&&e.rdo.user._id!=e.userLogged._id?i("q-btn",{staticClass:"col-3",attrs:{push:"",ripple:!1,label:"Conferma",color:"secondary",type:"submit"}}):e._e(),null==e.selectedRdo||e.rdo.user._id==e.userLogged._id||e.userLogged.admin?e._e():i("q-btn",{staticClass:"col-3",attrs:{push:"",ripple:!1,label:"Invia Ribasso",color:"secondary",type:"submit"},on:{click:e.inviaRibasso}})],1)],1)])},j=[];class K{constructor(){this.rdos=null,this.imports=null,this.regionOfInterest=void 0,this.expirationDate=void 0,this.user={},this.contractor=void 0,this.cmeFile={},this.images=[],this.peculiarity=void 0,this.startDate=void 0,this.endDate=void 0,this.needInspection=!1,this.reference=void 0,this.requiredDocuments=void 0,this.technicalFiles=[],this.description=void 0}}var G={name:"LoadRdo",props:["selectedRdo"],data(){return{rdo:new K,rdosCategories:null,rdosMacrocategories:null,rdosSubcategories:null,isValid:u["a"].isValid,imports:w["imports"],country:void 0,images:[],technicalFiles:[],cmeFile:void 0,expirationDate:void 0,startDate:void 0,endDate:void 0,currentLocale:{days:"_Lunedì_Martedì_Mercoledì_Giovedì_Sabato_Domenica".split("_"),daysShort:"Lun_Mar_Mer_Gio_Ven_Sab_Dom".split("_"),months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),firstDayOfWeek:0},ribasso:0,columns:[{name:"description",label:"File",align:"center"},{name:"download",label:"Download",align:"center"}],data:[],isTelephoneNumber:u["a"].isTelephoneNumber}},methods:l()(l()({},Object(c["b"])(["getMacroRdo","getCatRdo","getSubRdo","getRegions","getCountries","updateRdo","fetchUser","createRdo","uploadFile","fetchRdos","sendMail","fetchFile"])),{},{getData(){if(this.data.length>0&&(this.data=[]),this.rdo.images.forEach(((e,t)=>{e.index=t;const i={file:e};this.data.push(i)})),this.rdo.technicalFiles.forEach(((e,t)=>{e.index=t;const i={file:e};this.data.push(i)})),this.rdo.cmeFile){const e={file:this.rdo.cmeFile};this.data.push(e)}},async getRegionOptions(){await this.getRegions(this.country._id)},async getCatRdoOption(){if(null==this.rdosMacrocategories)this.rdosCategories=null,this.rdosSubcategories=null;else{const e={queryparams:{rdomacroId:this.rdosMacrocategories._id},order:"first"};await this.getCatRdo(e)}},async getSubcatRdoOption(){if(null==this.rdosCategories)this.rdosSubcategories=null;else{const e={queryparams:{rdocatId:this.rdosCategories._id},order:"first"};await this.getSubRdo(e)}},async loadRdo(){if(!this.$v.$invalid){this.$q.loading.show(),this.rdo.user=this.userLogged,this.rdo.rdos=this.rdosSubcategories,this.rdo.expirationDate=x["b"].extractDate(this.expirationDate,"DD/MM/YYYY"),this.rdo.startDate=x["b"].extractDate(this.startDate,"DD/MM/YYYY"),this.rdo.endDate=x["b"].extractDate(this.endDate,"DD/MM/YYYY");const e={pathParam:this.userLogged._id,body:this.rdo},t=await this.createRdo(e);await this.postFilesAndUpdateRdo(t.rdo),await this.fetchUser(e),await this.fetchRdos(),this.$emit("loadRdoSuccess",!1),this.$q.loading.hide()}},async postFilesAndUpdateRdo(e){const t=new FormData,i=this.cmeFile.name.split("."),s=i[i.length-1];t.append("file",this.cmeFile,`cmeFile.${s}`),this.images.forEach((e=>{const i=e.name.split("."),s=i[i.length-1];t.append("file",e,`images.${s}`)})),this.technicalFiles.forEach((e=>{const i=e.name.split("."),s=i[i.length-1];t.append("file",e,`technicalFiles.${s}`)}));const o=await this.uploadFile(t);o.files.forEach((t=>{"images"===t.originalname||"technicalFiles"===t.originalname?e[t.Key.split(".")[1]].push(t):e[t.Key.split(".")[1]]=t}));const a={pathParam:e._id+"/"+this.userLogged._id,body:e};await this.updateRdo(a)},calendarDataScadenza(e){const t=new Date,i=new Date;return this.addMonths(i,1),e>=t.toLocaleDateString("fr-CA").replaceAll("-","/")&&e<=i.toLocaleDateString("fr-CA").replaceAll("-","/")},calendarDataInizio(e){let t;if(null==this.expirationDate)t=new Date;else{const e=this.expirationDate.substr(0,2),i=this.expirationDate.substr(3,2),s=this.expirationDate.substr(6,4);t=new Date(i+"/"+e+"/"+s)}return e>=t.toLocaleDateString("fr-CA").replaceAll("-","/")},calendarDataFine(e){let t;if(null==this.startDate)t=new Date;else{const e=this.startDate.substr(0,2),i=this.startDate.substr(3,2),s=this.startDate.substr(6,4);t=new Date(i+"/"+e+"/"+s)}return e>=t.toLocaleDateString("fr-CA").replaceAll("-","/")},resetStartEndDate(){this.startDate=void 0,this.endDate=void 0},resetEndDate(){this.endDate=void 0},addMonths(e,t){var i=e.getDate();return e.setMonth(e.getMonth()+ +t),e.getDate()!==i&&e.setDate(0),e},async inviaRibasso(){this.$q.loading.show();const e={to:this.rdo.user.username,from:"dario.cascone93@gmail.com",subject:"Ricezione offerta per RDO: "+this.rdo.description,html:"Spett.le "+this.rdo.contractor+", <br/>l'operatore economico <strong>"+this.userLogged.companyName+"</strong> ha inviato la seguente offerta: <br/>Ribasso: <strong>"+this.ribasso+"%</strong><br/>Note: "+this.rdo.peculiarity+"<br/>"+this.rdo.requiredDocuments+'<br/><br/>Di seguito trova i link ai file relativi all\'azienda: <br/><a target="_blank" href="http://localhost:3000/'+this.rdo.user.durcRegolarityFile.path+'">Regolarità Durc</a><br/><a target="_blank" href="http://localhost:3000/'+this.rdo.user.certificateFile.path+'">Certificato o Visura Camerale</a><br/><a target="_blank" href="http://localhost:3000/'+this.rdo.user.lendingFile.path+'">Presentazione</a><br/><a target="_blank" href="http://localhost:3000/'+this.rdo.user.antimafiaFile.path+'">Dichiarazione sostitutiva antimafia</a><br/><br/>Distinti Saluti,<br/><span style="color:#29ABF4">Subapp.it s.r.l.s</span>'};await this.sendMail(e),this.$q.loading.hide()},async loadSelectedRdo(){this.rdo=JSON.parse(JSON.stringify(this.selectedRdo)),this.expirationDate=new Date(this.rdo.expirationDate).toLocaleDateString("fr"),this.startDate=new Date(this.rdo.startDate).toLocaleDateString("fr"),this.endDate=new Date(this.rdo.endDate).toLocaleDateString("fr");let e=null;e=this.loadSelectedRdoOptions("macroRdo",e),this.rdosMacrocategories=e,await this.getCatRdoOption();let t=null;t=this.loadSelectedRdoOptions("firstCatRdo",t),this.rdosCategories=t,await this.getSubcatRdoOption();let i=null;i=this.loadSelectedRdoOptions("firstSubRdo",i),this.rdosSubcategories=i},loadSelectedRdoOptions(e,t){return this[e].forEach((i=>{"macroRdo"===e&&i._id===this.rdo.rdos.macrocategory&&(t=i),"firstCatRdo"===e&&i._id===this.rdo.rdos.category&&(t=i),"firstSubRdo"===e&&i._id===this.rdo.rdos._id&&(t=i)})),t},async downloadFile(e){const t={pathParam:e},i=await this.fetchFile(t);window.open(i.url)}}),computed:l()({},Object(c["c"])({macroRdo:"macroRdo",userLogged:"user",firstCatRdo:"firstCatRdo",regions:"regions",firstSubRdo:"firstSubRdo",countries:"countries"})),async created(){this.selectedRdo?(await this.getMacroRdo(),await this.loadSelectedRdo(),this.getData()):(await this.getCountries(),this.selectedRdo||(this.country=this.countries.find((e=>"Italia"===e.description))),await this.getRegionOptions(),await this.getMacroRdo())},async mounted(){this.selectedRdo||(this.rdo.contractor=this.userLogged.companyName,this.$v.$touch())},validations(){return{rdo:{imports:{required:d["required"]},regionOfInterest:{required:d["required"]},contractor:{required:d["required"]},needInspection:{required:d["required"]},reference:{required:d["required"],isTelephoneOrEmail:u["a"].isTelephoneOrEmail},description:{required:d["required"]}},country:{required:d["required"]},rdosSubcategories:{required:d["required"]},rdosMacrocategories:{required:d["required"]},rdosCategories:{required:d["required"]},startDate:{required:d["required"]},endDate:{required:d["required"]},expirationDate:{required:d["required"]},cmeFile:{required:d["required"]}}}},B=G,W=i("c1d0"),Z=i("eaac"),J=i("bd08"),H=i("db86"),X=Object(m["a"])(B,U,j,!1,null,"7db89294",null),ee=X.exports;y()(X,"components",{QForm:g["a"],QInput:f["a"],QSlider:W["a"],QIcon:b["a"],QTooltip:I["a"],QPopupProxy:E["a"],QDate:T["a"],QBtn:v["a"],QSelect:M["a"],QFile:P["a"],QToggle:A["a"],QTable:Z["a"],QTr:J["a"],QTd:H["a"]}),y()(X,"directives",{ClosePopup:N["a"]});var te={name:"Modal",components:{LoadRdo:ee,SignIn:Y,Login:q},props:["component","modal","title","isMaximized","classObj","isEditing","selectedRdo","isAdmin","selectedUser"],data(){return{localModal:this.modal}},methods:{editSelectedUserSuccess(){this.$emit("editSelectedUserSuccess")},loginSuccess(e){this.$emit("update:modal",e)},signupSuccess(e){this.$emit("update:modal",e),this.$emit("signupSuccess")},loadRdoSuccess(e){this.$emit("update:modal",e)},editSuccess(e){this.$emit("update:modal",e)},hideDialog(){this.$emit("update:modal",this.localModal)}},watch:{modal(e,t){t!==e&&(this.localModal=e)}}},ie=te,se=i("24e8"),oe=i("f09f"),ae=i("a370"),re=Object(m["a"])(ie,s,o,!1,null,null,null);t["a"]=re.exports;y()(re,"components",{QDialog:se["a"],QCard:oe["a"],QCardSection:ae["a"],QBtn:v["a"]}),y()(re,"directives",{ClosePopup:N["a"]})},"8f04":function(e,t,i){"use strict";t["a"]={isFiscalCode:e=>{if(e){const t=new RegExp("^([A-Za-z]{6}[0-9lmnpqrstuvLMNPQRSTUV]{2}[abcdehlmprstABCDEHLMPRST]{1}[0-9lmnpqrstuvLMNPQRSTUV]{2}[A-Za-z]{1}[0-9lmnpqrstuvLMNPQRSTUV]{3}[A-Za-z]{1})|([0-9]{11})$");return t.test(e)}return!1},isSDICode:e=>{if(e){const t=new RegExp("^[a-zA-Z0-9]{7,}$");return t.test(e)}return!1},isVatNumber:e=>{if(e){const t=new RegExp("^[0-9]{11}$");return t.test(e)}return!1},isPostalCode:e=>{if(e){const t=new RegExp("(?<!\\d)\\d{5}(?!\\d)");return t.test(e)}return!1},isWebSite:e=>{if(e){const t=new RegExp("(https?:\\/\\/)?(www\\.)[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)|(https?:\\/\\/)?(www\\.)?(?!ww)[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)");return t.test(e)}return!1},isTelephoneNumber:e=>{if(e){const t=new RegExp("^((00|\\+)39[\\. ]??)??[0-9]\\d{2}[\\. ]??\\d{7,9}$");return t.test(e)}return!1},isTelephoneOrEmail:e=>{if(e){const t=new RegExp("^((00|\\+)39[\\. ]??)??[0-9]\\d{2}[\\. ]??\\d{7,9}$"),i=new RegExp("^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$");return t.test(e)||i.test(e)}return!1},isPassword:e=>{if(e){const t=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{6,}$");return t.test(e)}return!1},isValid:(e,t,i)=>{if(i.$error){if(!1===i[e].required)return"Campo obbligatorio!";switch(e){case"username":if(!i[e].email)return"Username non valida! Inserire un indirizzo email!";break;case"password":if(!i[e].isPassword)return"'La password deve contentere almeno 6 caratteri di cui almeno 1 maiuscola, almeno 1 minuscola, almeno 1 numero ed almeno 1 carattere speciale (@, $, !, %, *, ?, &)'";break;case"SDICode":if(!i[e].isSDICode)return"Codice: "+t+" non valido!";break;case"vatNumber":if(!i[e].isVatNumber)return"P.iva: "+t+" non valida!";break;case"fiscalCode":if(!i[e].isFiscalCode)return"Codice: "+t+" non valido!";break;case"postalCode":if(!i[e].isPostalCode)return"CAP: "+t+" non valido!";break;case"webSite":if(""!==t&&!i[e].isWebSite)return"Sito: "+t+" non valido!";break;case"pec":if(!i[e].email)return"PEC: "+t+" non valida!";break;case"telephoneNumber":if(!i[e].isTelephoneNumber)return"Numero: "+t+" non valido!";break;case"emailFrom":if(!i[e].email)return"Email: "+t+" non valida!";break;case"reference":if(!i[e].isTelephoneOrEmail)return"Contatto: "+t+" non valido!";break}}return!0}}},d539:function(e,t){const i=["SS – Società semplice","SNC - Società in Nome Collettivo","SAS - Società in Accomandita Semplice","SRL - Società a Responsabilità Limitata","SPA - Società Per Azioni","SAPA - Società in Accomandita Per Azioni","Società cooperative"],s=["fino a 50.000€","da 50.000€ a 150.000€","da 150.000 a 258.000€","da 258.000 a 500.000€","oltre 500.000€"],o=[{label:"Micro impresa",value:"xs"},{label:"Piccola impresa",value:"sm"},{label:"Media impresa",value:"md"},{label:"Grande impresa",value:"lg"}];t.legalFormOptions=i,t.imports=s,t.compCatOptions=o}}]);